<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GSM Manager - Call</title>
    <link rel="stylesheet" href="css/common.css">
    <script src="https://cdn.jsdelivr.net/npm/sockjs-client@1/dist/sockjs.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/stompjs@2.3.3/lib/stomp.min.js"></script>
</head>

<body>
    <div class="main-container">
        <!-- Call Panel -->
        <div class="panel" style="flex: 1; display: flex; flex-direction: column;">
            <div class="panel-header">
                üìû G·ªçi ƒêi·ªán
            </div>

            <!-- Call Form -->
            <div style="padding: 1rem;">
                <div style="margin-bottom: 1rem;">
                    <label>COM Port:</label>
                    <select id="comPort" style="width: 100%; margin-top: 0.5rem;">
                        <option value="">-- Ch·ªçn COM Port --</option>
                    </select>
                </div>

                <div style="margin-bottom: 1rem;">
                    <label>S·ªë ƒëi·ªán tho·∫°i:</label>
                    <input type="text" id="phoneNumber" placeholder="0123456789"
                        style="width: 100%; margin-top: 0.5rem;">
                </div>

                <div style="margin-bottom: 1rem;">
                    <label>
                        <input type="checkbox" id="enableRecording" checked>
                        Ghi √¢m cu·ªôc g·ªçi
                    </label>
                </div>

                <div style="margin-bottom: 1rem;">
                    <label>Th·ªùi gian t·ªëi ƒëa (gi√¢y):</label>
                    <input type="number" id="maxDuration" value="30" min="5" max="300"
                        style="width: 100%; margin-top: 0.5rem;">
                </div>

                <button class="classic-button" onclick="makeCall()"
                    style="width: 100%; padding: 0.8rem; font-size: 16px;">
                    üìû G·ªçi ƒêi·ªán
                </button>
            </div>

            <!-- Call Status -->
            <div id="callStatus" style="padding: 1rem; display: none;">
                <div class="panel-header" style="margin-bottom: 0.5rem;">
                    üìä Tr·∫°ng Th√°i Cu·ªôc G·ªçi
                </div>
                <div style="background: white; padding: 1rem; border: 2px inset #6b9bc4;">
                    <div style="margin-bottom: 0.5rem;">
                        <strong>Tr·∫°ng th√°i:</strong> <span id="callState" class="status-badge">IDLE</span>
                    </div>
                    <div style="margin-bottom: 0.5rem;">
                        <strong>Ghi √¢m:</strong> <span id="recordingState" class="status-badge">IDLE</span>
                    </div>
                    <div style="margin-bottom: 0.5rem;">
                        <strong>S·ªë g·ªçi:</strong> <span id="targetNumber">-</span>
                    </div>
                    <div style="margin-bottom: 0.5rem;">
                        <strong>Th·ªùi gian:</strong> <span id="duration">0s</span>
                    </div>
                    <div style="margin-top: 1rem;">
                        <button class="classic-button" onclick="endCall()" style="width: 100%; background: #ff6666;">
                            üì¥ K·∫øt Th√∫c Cu·ªôc G·ªçi
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Call History Panel -->
        <div class="panel" style="flex: 2; display: flex; flex-direction: column;">
            <div class="panel-header" style="display: flex; justify-content: space-between; align-items: center;">
                <span>üìã L·ªãch S·ª≠ Cu·ªôc G·ªçi</span>
                <button class="classic-button" onclick="loadCallHistory()" style="padding: 0.4rem 1rem;">
                    üîÑ Refresh
                </button>
            </div>

            <div style="flex: 1; overflow-y: auto;">
                <div class="data-grid" style="max-height: none; height: 100%;">
                    <table class="sim-table">
                        <thead>
                            <tr>
                                <th style="width: 120px;">Th·ªùi gian</th>
                                <th style="width: 100px;">COM Port</th>
                                <th style="width: 120px;">S·ªë ƒëi·ªán tho·∫°i</th>
                                <th style="width: 80px;">Th·ªùi l∆∞·ª£ng</th>
                                <th style="width: 100px;">Tr·∫°ng th√°i</th>
                                <th style="width: 150px;">File ghi √¢m</th>
                            </tr>
                        </thead>
                        <tbody id="callHistoryList">
                            <tr>
                                <td colspan="6" style="text-align: center; padding: 3rem; color: #808080;">
                                    Ch∆∞a c√≥ l·ªãch s·ª≠ cu·ªôc g·ªçi
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <script src="js/common.js"></script>
    <script src="js/layout.js"></script>
    <script src="js/call.js"></script>
</body>

</html>